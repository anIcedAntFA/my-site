---
import { getCollection, render } from 'astro:content';

import { MARKDOWN_COMPONENTS } from '@/config/component.config';
import PostDetailLayout from '@/layout/post-detail-layout.astro';
import type { RemarkPluginFrontmatter } from '@/types/remark';

export async function getStaticPaths() {
	const posts = await getCollection('blog');

	return posts.map((post) => ({
		params: { slug: post.id },
		props: post,
	}));
}

const post = Astro.props;

const { Content, remarkPluginFrontmatter } = await render(post);

const frontmatter = remarkPluginFrontmatter as RemarkPluginFrontmatter;
---

<PostDetailLayout post={post} frontmatter={frontmatter}>
	<Content components={MARKDOWN_COMPONENTS} />
</PostDetailLayout>
